#!/usr/bin/env bash
docker build -t bedrock .
ID=$( docker run -d -p 9998:80 -p 9999:81 -p 9997:27017 --name bedrockserver bedrock )
curl localhost:9998
curl localhost:9999

docker exec bedrockserver sh -c 'cd /var/www/bedrock && ./bin/setup.py'
if [ $? -ne 0 ]; then
    echo "FATAL: setup.py failed run docker rm -f $ID to remove docker instance"
    echo "FATAL: setup.py failed run docker exec -it $ID bash to connect to docker instance"
    exit 1
fi
